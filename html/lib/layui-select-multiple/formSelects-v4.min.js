"use strict";var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};(function(e,t,n){if((typeof exports==="undefined"?"undefined":_typeof(exports))==="object"){module.exports=n()}else if(typeof define==="function"&&define.amd){define(n)}else if(t.layui&&e.define){e.define(["jquery"],function(e){e("formSelects",n())})}else{t.formSelects=n()}})(typeof layui=="undefined"?null:layui,window,function(){var e="4.0.0.0702",t="xm-select",n="xm-select-parent",i="xm-select-input",a="xm-select--suffix",r="xm-select-this",l="xm-select-label",o="xm-select-search",s="xm-select-search-type",d="xm-select-show-count",f="xm-select-create",c="xm-select-create-long",u="xm-select-max",p="xm-select-skin",h="xm-select-direction",v="xm-select-height",m="xm-dis-disabled",y="xm-select-dis",g="xm-select-temp",x="xm-select-radio",b="xm-select-linkage",k="xm-select-dl",C="xm-hide-input",w="xm-select-sj",S="xm-icon-close",T="xm-select-title",j="xm-form-select",A="xm-form-selected",L="xm-select-none",H="xm-select-empty",E="xm-input",D="xm-dl-input",F="xm-select-tips",N="xm-icon-yes",O="xm-cz",P="xm-cz-group",V="请选择",_={},M={on:{},filter:{},maxTips:{}},U={type:"get",header:{},first:true,data:{},searchUrl:"",searchName:"keyword",searchVal:null,keyName:"name",keyVal:"value",keySel:"selected",keyDis:"disabled",keyChildren:"children",dataType:"",delay:500,beforeSuccess:null,success:null,error:null,beforeSearch:null,clearInput:false},B=[{icon:"iconfont icon-quanxuan",name:"全选",click:function e(t,n){n.selectAll(t,true,true)}},{icon:"iconfont icon-qingkong",name:"清空",click:function e(t,n){n.removeAll(t,true,true)}},{icon:"iconfont icon-fanxuan",name:"反选",click:function e(t,n){n.reverse(t,true,true)}},{icon:"iconfont icon-pifu",name:"换肤",click:function e(t,n){n.skin(t)}}],q=window.$||window.layui&&window.layui.jquery,I=q(window),W={},J=function e(n){var i=this;this.config={name:null,max:null,maxTips:function e(n,a,r){var l=q('[xid="'+i.config.name+'"]').prev().find("."+t);if(l.parents(".layui-form-item[pane]").length){l=l.parents(".layui-form-item[pane]")}l.attr("style","border-color: red !important");setTimeout(function(){l.removeAttr("style")},300)},init:null,on:null,filter:function e(t,n,i,a){return i.name.indexOf(n)==-1},clearid:-1,direction:"auto",height:null,isEmpty:false,btns:[B[0],B[1],B[2]],searchType:0,create:function e(t,n){return Date.now()},template:function e(t,n,i,a){return t},showCount:0,isCreate:false};this.select=null;this.values=[];q.extend(true,this.config,n)};var z=function e(){this.appender();this.init();this.on();this.initVal();this.onreset()};z.prototype.appender=function(){if(!Array.prototype.map){Array.prototype.map=function(e,t){var n,i,a,r=Object(this),l=r.length>>>0;if(t){n=t}i=new Array(l);a=0;while(a<l){var o,s;if(a in r){o=r[a];s=e.call(n,o,a,r);i[a]=s}a++}return i}}if(!Array.prototype.forEach){Array.prototype.forEach=function e(t,n){var i,a;if(this==null){throw new TypeError("this is null or not defined")}var r=Object(this);var l=r.length>>>0;if(typeof t!=="function"){throw new TypeError(t+" is not a function")}if(arguments.length>1){i=n}a=0;while(a<l){var o;if(a in r){o=r[a];t.call(i,o,a,r)}a++}}}};z.prototype.init=function(e){var r=this;q(e?e:"select["+t+"]").each(function(e,c){var m=q(c),g=m.attr(t),b=m.next(".layui-form-select"),S=c.disabled,A=m.attr(u)-0,L=m.attr(o)!=undefined,H=L?m.attr(o):null,F=m.attr(f)!=undefined,N=m.attr(x)!=undefined,O=m.attr(p),P=m.attr(h),M=c.options[0],B=m.attr(v),I=m.attr("name"),z=m.attr("lay-verify"),Q=m.attr("lay-verType"),X=m.attr(s)=="dl"?1:0,Y=m.attr(d)-0,$=M?M.value?V:M.innerHTML||V:V,G=m.find("option[selected]").toArray().map(function(e){return{name:e.innerHTML,val:e.value}}),K=new J;if(isNaN(Y)||Y<=0){Y=19921012}var R=_[g];_[g]=K;K.values=G;K.config.name=g;K.config.init=G.concat([]);K.config.direction=P;K.config.height=B;K.config.radio=N;K.config.searchType=X;K.config.showCount=Y;K.config.isCreate=F;if(R){q.extend(true,K.config,R.config);N=K.config.radio;O=K.config.skin;B=K.config.height;if(R.config.init){K.values=R.config.init.map(function(e){if((typeof e==="undefined"?"undefined":_typeof(e))=="object"){return e}return{name:m.find('option[value="'+e+'"]').text(),val:e}}).filter(function(e){return e.name});K.config.init=K.values.concat([])}}if(A){K.config.max=A}b[0]&&b.remove();var Z=r.renderSelect(g,$,c);var ee=!B||B=="auto"?"":'style="height: '+B+';"';var te=B?['<div class="'+l+'" style="margin-right: 50px;"></div>','<input type="text" fsw class="'+E+" "+i+'" '+(L?"":'style="display: none;"')+' autocomplete="off" debounce="0" style="position: absolute;right: 10px;top: 3px;"/>']:['<div class="'+l+'">','<input type="text" fsw class="'+E+" "+i+'" '+(L?"":'style="display: none;"')+' autocomplete="off" debounce="0" />',"</div>"];var ne=q('<div class="'+j+'" '+p+'="'+O+'">\n\t\t\t\t\t<input class="'+C+'" value="" name="'+I+'" lay-verify="'+z+'" lay-verType="'+Q+'" type="text" style="position: absolute;bottom: 0; z-index: -1;width: 100%; height: 100%; border: none; opacity: 0;"/>\n\t\t\t\t\t<div class="'+T+" "+(S?y:"")+'">\n\t\t\t\t\t\t<div class="'+E+" "+t+'" '+ee+">\n\t\t\t\t\t\t\t"+te.join("")+'\n\t\t\t\t\t\t\t<i class="'+w+'"></i>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="'+a+'">\n\t\t\t\t\t\t\t<input type="text" autocomplete="off" placeholder="'+$+'" readonly="readonly" unselectable="on" class="'+E+'">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<dl xid="'+g+'" class="'+k+" "+(N?x:"")+'">'+Z+"</dl>\n\t\t\t\t</div>");if(R){q('dl[xid="'+g+'"]').parents("."+n).html(ne);K.select=m}else{m.wrap('<div class="'+n+'" FS_ID="'+g+'"></div>');m.after(ne);K.select=m.remove()}if(L){W[g]=q.extend(true,{},U,{searchUrl:H});q(document).on("input propertychange","div."+n+'[FS_ID="'+g+'"] .'+i,function(e){r.search(g,e,H)});if(H){r.triggerSearch(ne,true)}}else{ne.find("dl dd."+D).css("display","none")}})};z.prototype.search=function(e,t,n,i){var a=this;var r=void 0;if(i){r=i}else{r=t.target;var l=t.keyCode;if(l===9||l===13||l===37||l===38||l===39||l===40){return false}}var o=q.trim(r.value);this.changePlaceHolder(q(r));var s=W[e]?W[e]:U;n=s.searchUrl||n;var d=_[e],f=d.config.isCreate,c=q('dl[xid="'+e+'"]').parents("."+j);if(n){if(s.searchVal){o=s.searchVal;s.searchVal=""}if(!s.beforeSearch||s.beforeSearch&&s.beforeSearch instanceof Function&&s.beforeSearch(e,n,o)){var u=s.delay;if(s.first){s.first=false;u=10}clearTimeout(d.clearid);d.clearid=setTimeout(function(){c.find("dl > *:not(."+F+")").remove();c.find("dd."+L).addClass(H).text("请求中");a.ajax(e,n,o,false,null,true)},u)}}else{c.find("dl .layui-hide").removeClass("layui-hide");c.find("dl dd:not(."+F+")").each(function(t,n){var i=q(n);var a=_[e].config.filter||M.filter[e];if(a&&a(e,o,{name:i.find("span").attr("name"),val:i.attr("lay-value")},i.hasClass(m))==true){i.addClass("layui-hide")}});c.find("dl dt").each(function(e,t){if(!q(t).nextUntil("dt",":not(.layui-hide)").length){q(t).addClass("layui-hide")}});this.create(e,f,o);var p=c.find("dl dd:not(."+F+"):not(.layui-hide)");if(!p.length){c.find("dd."+L).addClass(H).text("无匹配项")}else{c.find("dd."+L).removeClass(H)}}};z.prototype.isArray=function(e){return Object.prototype.toString.call(e)=="[object Array]"};z.prototype.triggerSearch=function(e,t){var n=this;(e?[e]:q("."+j).toArray()).forEach(function(e,a){e=q(e);var r=e.find("dl").attr("xid");if(r&&_[r]&&_[r].config.isEmpty||t){n.search(r,null,null,_[r].config.searchType==0?e.find("."+l+" ."+i):e.find("dl ."+D+" ."+i))}})};z.prototype.ajax=function(e,t,i,a,r,l){var o=this;var s=q("."+n+' dl[xid="'+e+'"]').parents("."+j);if(!s[0]||!t){return}var d=W[e]?W[e]:U;var f=q.extend(true,{},d.data);f[d.searchName]=i;q.ajax({type:d.type,headers:d.header,url:t,data:d.dataType=="json"?JSON.stringify(f):f,success:function n(f){if(typeof f=="string"){f=JSON.parse(f)}d.beforeSuccess&&d.beforeSuccess instanceof Function&&(f=d.beforeSuccess(e,t,i,f));if(o.isArray(f)){f={code:0,msg:"",data:f}}if(f.code!=0){s.find("dd."+L).addClass(H).text(f.msg)}else{s.find("dd."+L).removeClass(H);o.renderData(e,f.data,a,r,l);_[e].config.isEmpty=f.data.length==0}d.success&&d.success instanceof Function&&d.success(e,t,i,f)},error:function n(a){s.find("dd[lay-value]:not(."+F+")").remove();s.find("dd."+L).addClass(H).text("服务异常");d.error&&d.error instanceof Function&&d.error(e,t,i,a)}})};z.prototype.renderData=function(e,t,o,s,d){var f=this;if(o){var c=function(){var a=[],r=0,l={0:t},o=W[e]?W[e]:U;var d=function e(){var t=a[r++]=[],n=l;l={};q.each(n,function(e,n){q.each(n,function(n,i){var a={pid:e,name:i[o.keyName],val:i[o.keyVal]};t.push(a);var r=i[o.keyChildren];if(r&&r.length){l[a.val]=r}})})};do{d()}while(Object.getOwnPropertyNames(l).length);var f=q("."+n+' dl[xid="'+e+'"]').parents("."+j);var c=['<div class="xm-select-linkage">'];q.each(a,function(e,t){var n=['<div style="left: '+(s-0)*e+'px;" class="xm-select-linkage-group xm-select-linkage-group'+(e+1)+" "+(e!=0?"xm-select-linkage-hide":"")+'">'];q.each(t,function(e,t){var i='<li title="'+t.name+'" pid="'+t.pid+'" value="'+t.val+'"><span>'+t.name+"</span></li>";n.push(i)});n.push("</div>");c=c.concat(n)});c.push('<div style="clear: both; height: 288px;"></div>');c.push("</div>");f.find("dl").html(c.join(""));f.find("."+i).css("display","none");return{v:void 0}}();if((typeof c==="undefined"?"undefined":_typeof(c))==="object")return c.v}var u=q("."+n+' dl[xid="'+e+'"]').parents("."+j);var p=W[e]?W[e]:U;var h=u.find("."+a+" input");var v=[];u.find("dl").html(this.renderSelect(e,h.attr("placeholder")||h.attr("back"),t.map(function(e){if(e[p.keySel]){v.push({name:e[p.keyName],val:e[p.keyVal]})}return{innerHTML:e[p.keyName],value:e[p.keyVal],sel:e[p.keySel],disabled:e[p.keyDis],type:e.type,name:e.name}})));var m=u.find("."+l);var y=u.find("dl[xid]");if(d){var g=_[e].values;g.forEach(function(e,t){y.find('dd[lay-value="'+e.val+'"]').addClass(r)});v.forEach(function(t,n){if(f.indexOf(g,t)==-1){f.addLabel(e,m,t);y.find('dd[lay-value="'+t.val+'"]').addClass(r);g.push(t)}})}else{v.forEach(function(t,n){f.addLabel(e,m,t);y.find('dd[lay-value="'+t.val+'"]').addClass(r)});_[e].values=v}this.commonHanler(e,m)};z.prototype.create=function(e,t,n){if(t&&n){var i=_[e],a=q('[xid="'+e+'"]'),r=a.find("dd."+F+"."+D),l=null,o=a.find("dd."+g);a.find("dd:not(."+F+"):not(."+g+")").each(function(e,t){if(n==q(t).find("span").attr("name")){l=t}});if(!l){var s=i.config.create(e,name);if(o[0]){o.attr("lay-value",s);o.find("span").text(n);o.removeClass("layui-hide")}else{r.after(q(this.createDD(e,{innerHTML:n,value:s},g+" "+c)))}}}else{q("[xid="+e+"] dd."+g).remove()}};z.prototype.createDD=function(e,t,n){var i=q.trim(t.innerHTML);var a=_[e].config.template(i,t.value,t.selected,t.disabled);return'<dd lay-value="'+t.value+'" class="'+(t.disabled?m:"")+" "+(n?n:"")+'">\n\t\t\t\t\t<div class="xm-unselect xm-form-checkbox '+(t.disabled?m:"")+'">\n\t\t\t\t\t\t<i class="'+N+'"></i>\n\t\t\t\t\t\t<span name="'+i+'">'+a+"</span>\n\t\t\t\t\t</div>\n\t\t\t\t</dd>"};z.prototype.createQuickBtn=function(e,t){return'<div class="'+O+'" method="'+e.name+'" title="'+e.name+'" '+(t?'style="margin-right: '+t+'"':"")+'><i class="'+e.icon+'"></i><span>'+e.name+"</span></div>"};z.prototype.renderBtns=function(e,t,n){var i=this;var a=[];var r=q('dl[xid="'+e+'"]');a.push('<div class="'+P+'" show="'+t+'" style="max-width: '+(r.prev().width()-54)+'px;">');q.each(_[e].config.btns,function(e,t){a.push(i.createQuickBtn(t,n))});a.push("</div>");a.push(this.createQuickBtn({icon:"iconfont icon-caidan",name:""}));return a.join("")};z.prototype.renderSelect=function(e,t,n){var a=this;var r=[];if(_[e].config.btns.length){setTimeout(function(){var t=q('dl[xid="'+e+'"]');t.parents("."+j).attr(s,_[e].config.searchType);t.find("."+P).css("max-width",t.prev().width()-54+"px")},10);r.push(['<dd lay-value="" class="'+F+'" style="background-color: #FFF!important;">',this.renderBtns(e,null,"30px"),"</dd>",'<dd lay-value="" class="'+F+" "+D+'" style="background-color: #FFF!important;">','<i class="iconfont icon-sousuo"></i>','<input type="text" class="'+E+" "+i+'" placeholder="请搜索"/>',"</dd>"].join(""))}else{r.push('<dd lay-value="" class="'+F+'">'+t+"</dd>")}if(this.isArray(n)){q(n).each(function(t,n){if(n.type==="optgroup"){r.push("<dt>"+n.name+"</dt>")}else{r.push(a.createDD(e,n))}})}else{q(n).find("*").each(function(t,n){if(n.tagName.toLowerCase()=="option"&&t==0&&!n.value){return}if(n.tagName.toLowerCase()==="optgroup"){r.push("<dt>"+n.label+"</dt>")}else{r.push(a.createDD(e,n))}})}r.push('<dt style="display:none;"> </dt>');r.push('<dd class="'+F+" "+L+" "+(r.length===2?H:"")+'">没有选项</dd>');return r.join("")};z.prototype.on=function(){var e=this;this.one();q(document).on("click",function(t){if(!q(t.target).parents("."+T)[0]){q("."+i).val("");q("."+n+" dl .layui-hide").removeClass("layui-hide");q("."+n+" dl dd."+g).remove();e.triggerSearch();q.each(_,function(t,n){if(!n.values.length){e.changePlaceHolder(q('div[FS_ID="'+t+'"] .'+l))}})}q("."+n+" ."+A).removeClass(A)})};z.prototype.one=function(e){var n=this;q(e?e:document).off("click").on("click","."+T,function(e){var a=q(e.target),r=a.is(T)?a:a.parents("."+T),l=r.next(),o=l.attr("xid");q("dl[xid]").not(l).prev().find("."+i).val("");q("dl[xid]").not(l).find("dd.layui-hide").removeClass("layui-hide");if(r.hasClass(y)){return false}if(a.is("."+w)||a.is("."+i+"[readonly]")){n.changeShow(r,!r.parents("."+j).hasClass(A));return false}if(r.find("."+i+":not(readonly)")[0]){var s=r.find("."+i),d={x:e.pageX,y:e.pageY},f=n.getPosition(r[0]),c=r.width();while(d.x>f.x){if(q(document.elementFromPoint(d.x,d.y)).is(s)){s.focus();n.changeShow(r,true);return false}d.x-=50}}if(a.is("."+i)){n.changeShow(r,true);return false}if(a.is('i[fsw="'+t+'"]')){var u={name:a.prev().text(),val:a.parent().attr("value")},p=l.find("dd[lay-value='"+u.val+"']");if(p.hasClass(m)){return false}n.handlerLabel(o,p,false,u);return false}n.changeShow(r,!r.parents("."+j).hasClass(A));return false});q(e?e:document).find("dl."+k).off("click").on("click",function(e){var t=q(e.target);if(t.is("."+b)||t.parents("."+b)[0]){t=t.is("li")?t:t.parents("li");var i=t.parents(".xm-select-linkage-group"),a=t.parents("dl").attr("xid");i.find(".xm-select-active").removeClass("xm-select-active");t.addClass("xm-select-active");i.nextAll(".xm-select-linkage-group").addClass("xm-select-linkage-hide");var l=i.next(".xm-select-linkage-group");l.find("li").addClass("xm-select-linkage-hide");l.find('li[pid="'+t.attr("value")+'"]').removeClass("xm-select-linkage-hide");if(!l[0]||l.find("li:not(.xm-select-linkage-hide)").length==0){var o=[],s=0,d=!t.hasClass("xm-select-this");if(_[a].config.radio){t.parents(".xm-select-linkage").find(".xm-select-this").removeClass("xm-select-this")}do{o[s++]={name:t.find("span").text(),val:t.attr("value")};t=t.parents(".xm-select-linkage-group").prev().find('li[value="'+t.attr("pid")+'"]')}while(t.length);o.reverse();var f={name:o.map(function(e){return e.name}).join("/"),val:o.map(function(e){return e.val}).join("/")};n.handlerLabel(a,null,d,f)}else{l.removeClass("xm-select-linkage-hide")}return false}if(t.is("dl")){return false}if(t.is("dt")){t.nextUntil("dt").each(function(e,t){t=q(t);if(t.hasClass(m)||t.hasClass(r)){}else{t.click()}});return false}var c=t.is("dd")?t:t.parents("dd");var u=c.parent("dl").attr("xid");if(c.hasClass(m)){return false}if(c.hasClass(F)){var p=t.is("."+O)?t:t.parents("."+O);if(!p[0]){return false}var h=p.attr("method");var v=_[u].config.btns.filter(function(e){return e.name==h})[0];v&&v.click&&v.click instanceof Function&&v.click(u,n);return false}var y=!c.hasClass(r);n.handlerLabel(u,c,y);return false})};z.prototype.linkageAdd=function(e,t){var n=q('dl[xid="'+e+'"]');n.find(".xm-select-active").removeClass("xm-select-active");var i=t.val.split("/");var a=void 0,r=void 0,l=0;var o=[];do{a=i[l];r=n.find(".xm-select-linkage-group"+(l+1)+' li[value="'+a+'"]');r[0]&&o.push(r);l++}while(r.length&&a!=undefined);if(o.length==i.length){q.each(o,function(e,t){t.addClass("xm-select-this")})}};z.prototype.linkageDel=function(e,t){var n=q('dl[xid="'+e+'"]');var i=t.val.split("/");var a=void 0,r=void 0,l=i.length-1;do{a=i[l];r=n.find(".xm-select-linkage-group"+(l+1)+' li[value="'+a+'"]');if(!r.parent().next().find("li[pid="+a+"].xm-select-this").length){r.removeClass("xm-select-this")}l--}while(r.length&&a!=undefined)};z.prototype.valToName=function(e,t){var n=q('dl[xid="'+e+'"]');var i=(t+"").split("/");var a=[];q.each(i,function(e,t){var i=n.find(".xm-select-linkage-group"+(e+1)+' li[value="'+t+'"] span').text();a.push(i)});return a.length==i.length?a.join("/"):null};z.prototype.commonHanler=function(e,i){this.changePlaceHolder(i);this.retop(i.parents("."+j));this.checkHideSpan(e,i);this.calcLeft(e,i);i.parents("."+n).find("."+C).val(_[e].values.map(function(e){return e.val}).join(","));i.parents("."+T+" ."+t).attr("title",_[e].values.map(function(e){return e.name}).join(","))};z.prototype.initVal=function(e){var t=this;var n={};if(e){n[e]=_[e]}else{n=_}q.each(n,function(e,n){var i=n.values,a=q('dl[xid="'+e+'"]').parent(),o=a.find("."+l),s=a.find("dl");s.find("dd."+r).removeClass(r);var d=i.concat([]);d.concat([]).forEach(function(n,i){t.addLabel(e,o,n);s.find('dd[lay-value="'+n.val+'"]').addClass(r)});if(n.config.radio){d.length&&i.push(d[d.length-1])}t.commonHanler(e,o)})};z.prototype.handlerLabel=function(e,t,a,o,s){var d=q('[xid="'+e+'"]').prev().find("."+l),f=t&&{name:t.find("span").attr("name"),val:t.attr("lay-value")},c=_[e].values,u=_[e].config.on||M.on[e];if(o){f=o}var p=_[e];if(a&&p.config.max&&p.values.length>=p.config.max){var h=_[e].config.maxTips||M.maxTips[e];h&&h(e,c.concat([]),f,p.max);return}if(!s){if(u&&u instanceof Function&&u(e,c.concat([]),f,a,t&&t.hasClass(m))==false){return}}var v=q('dl[xid="'+e+'"]');a?(t&&t[0]?(t.addClass(r),t.removeClass(g)):v.find(".xm-select-linkage")[0]&&this.linkageAdd(e,f),this.addLabel(e,d,f),c.push(f)):(t&&t[0]?t.removeClass(r):v.find(".xm-select-linkage")[0]&&this.linkageDel(e,f),this.delLabel(e,d,f),this.remove(c,f));if(!d[0])return;if(p.config.radio){this.changeShow(d,false)}d.parents("."+T).prev().removeClass("layui-form-danger");p.config.clearInput&&d.parents("."+n).find("."+i).val("");this.commonHanler(e,d)};z.prototype.addLabel=function(e,n,i){if(!i)return;var a='fsw="'+t+'"';var l=[q("<span "+a+' value="'+i.val+'"><font '+a+">"+i.name+"</font></span>"),q("<i "+a+' class="xm-icon-close">×</i>')],o=l[0],s=l[1];o.append(s);var d=_[e];if(d.config.radio){d.values.length=0;q('dl[xid="'+e+'"]').find("dd."+r+':not([lay-value="'+i.val+'"])').removeClass(r);n.find("span").remove()}if(d.config.height){n.append(o)}else{n.find("input").css("width","50px");n.find("input").before(o)}};z.prototype.delLabel=function(e,t,n){if(!n)return;t.find('span[value="'+n.val+'"]:first').remove()};z.prototype.calcLeft=function(e,t){if(_[e].config.height){var n=t.find("span:not(.xm-span-hide):last")[0];t.next().css("left",(n?this.getPosition(n).x-this.getPosition(t[0]).x+n.offsetWidth+20:10)+"px")}};z.prototype.checkHideSpan=function(e,n){var i=this;var a=n.parents("."+t)[0].offsetHeight+5;n.find("span.xm-span-hide").removeClass("xm-span-hide");n.find("span[style]").remove();var r=_[e].config.showCount;n.find("span").each(function(e,t){if(e>=r){q(t).addClass("xm-span-hide")}if(t.offsetHeight+t.offsetTop>a||i.getPosition(t).y+t.offsetHeight>i.getPosition(n[0]).y+n[0].offsetHeight+5){q(t).addClass("xm-span-hide")}});var l=n.find("span:eq("+r+")");l[0]&&l.before(q('<span style="padding-right: 6px;" fsw="'+t+'"> + '+(n.find("span").length-r)+"</span>"))};z.prototype.retop=function(e){var n=e.find("dl"),i=e.offset().top+e.outerHeight()+5-I.scrollTop(),a=n.outerHeight();var r=e.hasClass("layui-form-selectup")||n.css("top").indexOf("-")!=-1||i+a>I.height()&&i>=a;e=e.find("."+t);var l=_[n.attr("xid")];var o=n.parents(".layui-form-pane")[0]&&n.prev()[0].clientHeight>38?14:10;if(l){if(l.config.direction=="up"){n.css({top:"auto",bottom:"42px"});return}if(l.direction=="down"){n.css({top:e[0].offsetTop+e.height()+o+"px",bottom:"auto"});return}}if(r){n.css({top:"auto",bottom:"42px"})}else{n.css({top:e[0].offsetTop+e.height()+o+"px",bottom:"auto"})}};z.prototype.changeShow=function(e,t){q(".layui-form-selected").removeClass("layui-form-selected");var a=e.parents("."+j);q("."+n+" ."+j).not(a).removeClass(A);if(t){this.retop(a);a.addClass(A);a.find("."+i).focus()}else{a.removeClass(A);a.find("."+i).val("");a.find("dl .layui-hide").removeClass("layui-hide");a.find("dl dd."+g).remove();var r=a.find("dl").attr("xid");if(r&&_[r]&&_[r].config.isEmpty){this.triggerSearch(a)}}};z.prototype.changePlaceHolder=function(e){var r=e.parents("."+T);r[0]||(r=e.parents("dl").prev());if(!r[0]){return}var l=e.parents("."+n).find("dl[xid]").attr("xid");if(_[l]&&_[l].config.height){}else{var o=r.find("."+t)[0].clientHeight;r.css("height",(o>34?o+4:o)+"px");var s=r.parents("."+n).parent().prev();if(s.is(".layui-form-label")&&r.parents(".layui-form-pane")[0]){o=o>36?o+4:o;r.css("height",o+"px");s.css({height:o+2+"px",lineHeight:o-18+"px"})}}var d=r.find("."+a+" input"),f=!e.find("span:last")[0]&&!r.find("."+i).val();if(f){var c=d.attr("back");d.removeAttr("back");d.attr("placeholder",c)}else{var u=d.attr("placeholder");d.removeAttr("placeholder");d.attr("back",u)}};z.prototype.indexOf=function(e,t){for(var n=0;n<e.length;n++){if(e[n].val==t||e[n].val==(t?t.val:t)||e[n]==t||JSON.stringify(e[n])==JSON.stringify(t)){return n}}return-1};z.prototype.remove=function(e,t){var n=this.indexOf(e,t?t.val:t);if(n>-1){e.splice(n,1);return true}return false};z.prototype.selectAll=function(e,t,n){var i=this;var a=q('[xid="'+e+'"]');if(a.find(".xm-select-linkage")[0]){return}a.find("dd[lay-value]:not(."+F+"):not(."+r+")"+(n?":not(."+m+")":"")).each(function(n,r){r=q(r);var l={name:r.find("span").attr("name"),val:r.attr("lay-value")};i.handlerLabel(e,a.find('dd[lay-value="'+l.val+'"]'),true,l,!t)})};z.prototype.removeAll=function(e,t,n){var i=this;var a=q('[xid="'+e+'"]');if(a.find(".xm-select-linkage")[0]){_[e].values.concat([]).forEach(function(e,t){var n=e.val.split("/");var i=void 0,r=void 0,l=0;do{i=n[l++];r=a.find(".xm-select-linkage-group"+l+':not(.xm-select-linkage-hide) li[value="'+i+'"]');r.click()}while(r.length&&i!=undefined)});return}_[e].values.concat([]).forEach(function(r,l){if(n&&a.find('dd[lay-value="'+r.val+'"]').hasClass(m)){}else{i.handlerLabel(e,a.find('dd[lay-value="'+r.val+'"]'),false,r,!t)}})};z.prototype.reverse=function(e,t,n){var i=this;var a=q('[xid="'+e+'"]');if(a.find(".xm-select-linkage")[0]){return}a.find("dd[lay-value]:not(."+F+")"+(n?":not(."+m+")":"")).each(function(n,l){l=q(l);var o={name:l.find("span").attr("name"),val:l.attr("lay-value")};i.handlerLabel(e,a.find('dd[lay-value="'+o.val+'"]'),!l.hasClass(r),o,!t)})};z.prototype.skin=function(e){var t=["default","primary","normal","warm","danger"];var i=t[Math.floor(Math.random()*t.length)];q('dl[xid="'+e+'"]').parents("."+n).find("."+j).attr("xm-select-skin",i);this.commonHanler(e,q('dl[xid="'+e+'"]').parents("."+n).find("."+l))};z.prototype.getPosition=function(e){var t=0,n=0;while(e!=null){t+=e.offsetLeft;n+=e.offsetTop;e=e.offsetParent}return{x:t,y:n}};z.prototype.onreset=function(){q(document).on("click","[type=reset]",function(e){q(e.target).parents("form").find("."+n+" dl[xid]").each(function(e,t){var n=t.getAttribute("xid"),i=q(t),a=void 0,r={};X.removeAll(n);_[n].config.init.forEach(function(e,t){if(e&&(!r[e]||_[n].config.repeat)&&(a=i.find('dd[lay-value="'+e.val+'"]'))[0]){X.handlerLabel(n,a,true);r[e]=1}})})})};var Q=function t(){this.v=e};var X=new z;Q.prototype.value=function(e,t,n){if(typeof e!="string"){return[]}var i=_[e];if(!i){return[]}if(typeof t=="string"||t==undefined){var a=i.values.concat([])||[];if(t=="val"){return a.map(function(e){return e.val})}if(t=="valStr"){return a.map(function(e){return e.val}).join(",")}if(t=="name"){return a.map(function(e){return e.name})}if(t=="nameStr"){return a.map(function(e){return e.name}).join(",")}return a}if(X.isArray(t)){var r=q('[xid="'+e+'"]'),l={},o=void 0,s=true;if(n==false){s=false}else if(n==true){s=true}else{X.removeAll(e)}if(s){i.values.forEach(function(e,t){l[e.val]=1})}t.forEach(function(t,n){if(t&&(!l[t]||i.config.repeat)){if((o=r.find('dd[lay-value="'+t+'"]'))[0]){X.handlerLabel(e,o,s,null,true);l[t]=1}else{var a=X.valToName(e,t);if(a){X.handlerLabel(e,o,s,{name:a,val:t},true);l[t]=1}}}})}};z.prototype.bindEvent=function(e,t,n){if(t&&t instanceof Function){n=t;t=null}if(n&&n instanceof Function){if(!t){q.each(_,function(t,i){_[t]?_[t].config[e]=n:M[e][t]=n})}else{_[t]?_[t].config[e]=n:M[e][t]=n}}};Q.prototype.on=function(e,t){X.bindEvent("on",e,t);return this};Q.prototype.filter=function(e,t){X.bindEvent("filter",e,t);return this};Q.prototype.maxTips=function(e,t){X.bindEvent("maxTips",e,t);return this};Q.prototype.config=function(e,t,i){if(e&&(typeof e==="undefined"?"undefined":_typeof(e))=="object"){i=t==true;t=e;e=null}if(t&&(typeof t==="undefined"?"undefined":_typeof(t))=="object"){if(i){t.header||(t.header={});t.header["Content-Type"]="application/json; charset=UTF-8";t.dataType="json"}e?(W[e]=q.extend(true,{},W[e]||U,t),_[e]&&(_[e].config.direction=t.direction),t.searchUrl&&_[e]&&X.triggerSearch(q("."+n+' dl[xid="'+e+'"]').parents("."+j),true)):(q.extend(true,U,t),q.each(W,function(e,n){q.extend(true,n,t)}))}return this};Q.prototype.render=function(e,i){var a=this;if(e&&(typeof e==="undefined"?"undefined":_typeof(e))=="object"){i=e;e=null}var r={};e?_[e]&&(r[e]=_[e]):r=_;var l=i?{init:i.init,skin:i.skin,height:i.height,radio:i.radio,direction:i.direction,create:i.create,filter:i.filter,max:i.max,maxTips:i.maxTips,on:i.on,searchType:i.searchType,template:i.template,showCount:i.showCount,isCreate:i.isCreate}:{};if(Object.getOwnPropertyNames(r).length){q.each(r,function(e,t){a.value(e,[]);q.extend(_[e].config,l);X.init(t.select);X.one(q('dl[xid="'+e+'"]').parents("."+n));X.initVal(e)})}(q("select["+t+'="'+e+'"]')[0]?q("select["+t+'="'+e+'"]'):q("select["+t+"]")).each(function(e,i){var a=i.getAttribute(t);X.init(i);X.one(q('dl[xid="'+a+'"]').parents("."+n));X.initVal(a)});return this};Q.prototype.disabled=function(e){var t={};e?_[e]&&(t[e]=_[e]):t=_;q.each(t,function(e,t){q('dl[xid="'+e+'"]').prev().addClass(y)});return this};Q.prototype.undisabled=function(e){var t={};e?_[e]&&(t[e]=_[e]):t=_;q.each(t,function(e,t){q('dl[xid="'+e+'"]').prev().removeClass(y)});return this};Q.prototype.data=function(e,t,n){if(!e||!t||!n){return this}!_[e]&&this.render(e);if(!_[e]){return this}this.value(e,[]);this.config(e,n);if(t=="local"){X.renderData(e,n.arr,n.linkage==true,n.linkageWidth?n.linkageWidth:"100")}else if(t=="server"){X.ajax(e,n.url,n.keyword,n.linkage==true,n.linkageWidth?n.linkageWidth:"100")}return this};Q.prototype.btns=function(e,t,n){if(!t||!X.isArray(t)){return this}var i={};e?_[e]&&(i[e]=_[e]):i=_;t=t.map(function(e){if(typeof e=="string"){if(e=="select"){return B[0]}if(e=="remove"){return B[1]}if(e=="reverse"){return B[2]}if(e=="skin"){return B[3]}}return e});q.each(i,function(e,i){i.config.btns=t;var r=q('dl[xid="'+e+'"]').find("."+F+":first");if(t.length){var l=n&&n.show&&(n.show=="name"||n.show=="icon")?n.show:"";var o=X.renderBtns(e,l,n&&n.space?n.space:"30px");r.html(o)}else{var s=r.parents("."+j).find("."+a+" input");var d=s.attr("placeholder")||s.attr("back");r.html(d);r.removeAttr("style")}});return this};Q.prototype.search=function(e,t){if(e&&_[e]){W[e]=q.extend(true,{},W[e]||U,{first:true,searchVal:t});X.triggerSearch(q('dl[xid="'+e+'"]').parents("."+j),true)}return this};return new Q});